## Рекомендации на основе содержания

Цель: Познакомиться с рекомендациями на основе содержания, применить TF-IDF на тегах и жанрах фильмов, оценить RMSE

Описание: нужно решить задачу регрессии, сделать модель предсказания какую оценку поставят фильму, 
основываясь на средней оценки по другим фильмам, учитывая такие переменные, 
как жанры и тэги к фильмам

### MovieLens Latest Datasets

Описание датасета ['MovieLens Latest Datasets'](https://grouplens.org/datasets/movielens/latest/)


### Этапы работы:

1. Загрузили данные из файлоов
2. Объединили таблицы по необходимым ключам
3. Создали TF-IDF признаки для тегов и жанров
4. Вычислили средние оценки пользователя и фильма
5. Объединили все признаки в один датафрейм
6. Разделили данные на обучающую и тестовую выборки
7. Обучили различные модели
8. Предсказали оценки на тестовой выборке
9. Оценили модели с использованием RMSE




|                   | 0         | 1         | 2         | 3         | 4         | 5         | 6         | 7         | 8         | 9         | RMSE      |
|-------------------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
| Actual Ratings    | 4.000000  | 4.000000  | 2.500000  | 3.000000  | 2.500000  | 0.500000  | 4.000000  | 3.000000  | 4.000000  | 3.000000  | 0.000000  |
| LinearRegression  | 3.977245  | 3.251672  | 3.184650  | 2.704847  | 3.018909  | 1.042168  | 4.189824  | 2.967925  | 3.588403  | 3.385972  | 0.834886  |
| RandomForestRegressor | 4.250000  | 2.450000  | 2.900000  | 2.850000  | 3.150000  | 0.500000  | 4.500000  | 3.950000  | 4.800000  | 3.200000  | 0.878358  |
| KNeighborsRegressor | 3.900000  | 3.000000  | 3.500000  | 3.200000  | 2.900000  | 0.700000  | 4.200000  | 3.700000  | 4.000000  | 3.400000  | 0.887845  |
| Ridge             | 3.979732  | 3.253615  | 3.184960  | 2.711379  | 3.021916  | 1.028562  | 4.193072  | 2.965737  | 3.594187  | 3.386894  | 0.811300  |
| Lasso             | 3.889726  | 3.363251  | 3.416328  | 3.152752  | 3.230832  | 1.649884  | 3.906795  | 3.092688  | 3.602849  | 3.384742  | 0.851481  |


<hr>
<b>Вывод:</b> Таким образом, основываясь на графики, можно сказать, что модели часто делают похожие ошибки. 
Так как мы используем Clip, то есть наши значения не могут быть за пределами [0,5], 
то большинство ошибок концентрируется вокруг 0 и 5 соответственно. На самом деле, только у линейной регрессии 
были замечены сильные отклонения из-за неиспользования clip, остальные модели более-менее стабильны.
KNN обучается очень долго. LinearRegression и RandomForest быстрее, но все же приходится ждать, еще многое от параметров зависит.  
С базовыми параметрами, конечно, выигрывает Ridge и Lasso. Очень быстрое обучение и хорошая метрика по итогу.
<hr>






