# Гибридные рекомендательные системы

Цель: определить какую оценку поставит пользователь с наибольшей точностью

Описание: датасет [MovieLens Small Dataset](https://grouplens.org/datasets/movielens/latest/)  
Общее: [датасет информация](https://grouplens.org/datasets/movielens/)

Гибридные рекомендательные системы объединяют различные методы для повышения качества рекомендаций. Существует несколько подходов к гибридным системам, и их можно классифицировать по разным критериям. Например, можно выделить следующие основные подходы:

### Content-Based Filtering (CBF)

Рекомендации основаны на характеристиках предметов (item features) и на предпочтениях пользователя. Этот подход подразумевает анализ контента и использование его для предсказания предпочтений пользователя.

### Collaborative Filtering (CF)

Рекомендации основаны на схожести между пользователями или предметами. В этом случае используются оценки пользователей или их действия для определения схожести.

### Hybrid Models

Комбинируют подходы CBF и CF для получения более точных рекомендаций. Это может быть выполнено как последовательно (например, сначала CBF, затем CF) или параллельно.


В моей модели мы анализировали топ-5 фильмов.  

**CBF**   

Основано на схожести фильмов, составлены рекомендации на основе схожести по жанрам фильмов, оцененной с использованием TF-IDF. В дополнении стоит учитывать оценки, поставленные пользователями фильмам, возможно режиссера, описание (если есть) и тд и тп.  

**CF**   
```python
# Обучение коллаборативной модели
sim_options = {'name': 'cosine', 'user_based': False}
model = KNNBasic(sim_options=sim_options)
model.fit(trainset)
```
- Создает набор данных, исключая из тестового набора оценки, которые уже есть в обучающем наборе. Этот набор данных представляет собой "анти-тестовый" набор для пользователя, содержащий элементы, которые пользователь ещё не оценил.
- Использует модель коллаборативной фильтрации для предсказания оценок для элементов, включенных в анти-тестовый набор данных пользователя.
- Сортирует предсказания по оценкам (est) в убывающем порядке и выбирает топ-N предсказаний, чтобы определить наилучшие рекомендации.
- Извлекает идентификаторы рекомендованных фильмов из топовых предсказаний.
- По идентификаторам фильмов извлекает их названия из базы данных фильмов.

**Hybrid**  

Комбинирование предсказания от обоих подходов.  
Для начала берем топ 1000 фильмов из каждого подхода. Каждому фильму выдаем значение от 1ого до 1000. Каждое значение умножаем на вес в зависимости от подхода. CBF на 0.3, СF на 0.7, так как наиболее рекомендуемы фильм имеет наименьшее число, поэтому чем меньше вес, тем лучше. После чего значения складываются и выводятся топ-5 фильмов с наименьшим весом.




